{"Function":"\r\n    function Invoke-PowerShell {\r\n        param (\r\n            $Name,\r\n            $Command,\r\n            $Detection\r\n        )\r\n        Write-Log -Value \"Detecting $Name\" -Severity 1 -Component \"Invoke-PowerShell\"\r\n\r\n        $runDetectionRule = Invoke-Expression -Command $Detection\r\n        if (!($runDetectionRule -eq $true)) {\r\n            $Arguments = \"-Command $Command\"\r\n            Write-Log -Value \"Starting powershell.exe with arguments: $Arguments\" -Severity 1 -Component \"Invoke-PowerShell\"\r\n            Start-Process -FilePath \"powershell.exe\" -ArgumentList $Arguments\r\n        }\r\n        else {\r\n            Write-Log -Value \"$Name is already run\" -Severity 1 -Component \"Invoke-PowerShell\"\r\n        }\r\n    }\r\n","Execute":"\r\n    param(\r\n        $cfguri = $null\r\n    )\r\n    if ($cfguri -ne $null) {\r\n        $cfg = Invoke-RestMethod $cfguri -UseBasicParsing\r\n        foreach ($i in $cfg) {\r\n            Invoke-PowerShell -Name $i.Name -Command $i.Command -Detection $i.Detection\r\n        }\r\n    }\r\n","Name":"Invoke-PowerShell"}
