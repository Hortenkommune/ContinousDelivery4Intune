{"Function":"\r\n    function Invoke-Chocolatey {\r\n        param (\r\n            $Application,\r\n            $Mode\r\n        )\r\n        $ChocoBin = $env:ProgramData + \"\\Chocolatey\\bin\\choco.exe\"\r\n        Write-Log -Value \"Running $Mode on $Application\" -Severity 1 -Component \"Invoke-Chocolatey\"\r\n        try {\r\n            Invoke-Expression \"cmd /c $ChocoBin $Mode $Application -y\" -ErrorAction Stop\r\n        }\r\n        catch {\r\n            Write-Log -Value \"Failed to run $Mode on $Application\" -Severity 3 -Component \"Invoke-Chocolatey\"\r\n        }\r\n    }\r\n","Execute":"\r\n    param(\r\n        $cfguri = $null\r\n    )\r\n    if ($cfguri -ne $null) {\r\n        $cfg = Invoke-RestMethod $cfguri -UseBasicParsing\r\n        foreach ($i in $cfg) {\r\n            Invoke-Chocolatey -Application $i.Application -Mode $i.Mode\r\n        }\r\n    }\r\n","Name":"Invoke-Chocolatey"}
