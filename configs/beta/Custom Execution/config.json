[{"wrkDir":"C:\\Windows\\Temp","Detection":[{"Rule":"[bool](Get-WmiObject -Query \"select * from win32_printer where name like \u0027%HK-ELEVv1%\u0027\")"}],"Name":"Deploy printer","FilesToDwnload":[{"FileName":"Install-HKELEVv1.ps1","URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Install-HKELEVv1.ps1"},{"FileName":"cnlb0m.zip","URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/bin/cnlb0m.zip"},{"FileName":"lprport.reg","URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/regfiles/lprport.reg"}],"Execution":[{"Execute":"powershell.exe","Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Install-HKELEVv1.ps1"}]},{"wrkDir":"C:\\Windows\\Temp","Detection":[{"Rule":"[bool](!(Get-WmiObject -Query \"select * from win32_computersystem where model like \u002720DA%\u0027\")) -or (Get-WmiObject -Query \"select * from win32_PnPSignedDriver where DeviceName like \u0027I2C Controller\u0027\")"}],"Name":"Fix 20DA Touchscreen","FilesToDwnload":[{"FileName":"Install-TS20DAFix.ps1","URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Install-TS20DAFix.ps1"},{"FileName":"iaioi2ce.zip","URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/bin/iaioi2ce.zip"}],"Execution":[{"Execute":"powershell.exe","Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Install-TS20DAFix.ps1"}]},{"wrkDir":"C:\\Windows\\Temp","Detection":[{"Rule":"[bool](!(Get-WmiObject -Query \"select * from win32_computersystem where model like \u0027TravelMate Spin B118-RN\u0027\")) -or ((Get-WmiObject -Query \"select * from win32_PnPSignedDriver where DeviceName like \u0027Intel(R) HD Graphics\u0027\") | where {$_.driverversion -ge \u002724.20.100.6286\u0027})"}],"Name":"Upgrade Graphics Driver on Acer BR118-RN","FilesToDwnload":[{"FileName":"Install-HD505Graphics.ps1","URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Install-HD505Graphics.ps1"},{"FileName":"vga6286.zip","URL":"http://horten.kommune.no:83/filer/VGA6286.zip"}],"Execution":[{"Execute":"powershell.exe","Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Install-HD505Graphics.ps1"}]},{"wrkDir":"C:\\Windows\\Temp","Detection":[{"Rule":"$OP = (powercfg /query SCHEME_CURRENT 238c9fa8-0aad-41ed-83f4-97be242c8f20 bd3b718a-0680-4d9d-8ab2-e1d2b4ac806d);[bool]($OP -like \"*Current AC Power Setting Index: 0x00000001*\") -and ($OP -like \"*Current DC Power Setting Index: 0x00000001*\")"}],"Name":"Enable Wake Timers","FilesToDwnload":[{"FileName":"Run-PwrcfgWakeTimers.ps1","URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Run-PwrcfgWakeTimers.ps1"}],"Execution":[{"Execute":"powershell.exe","Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Run-PwrcfgWakeTimers.ps1"}]},{"wrkDir":"C:\\Windows\\Temp","Detection":[{"Rule":"(!(Get-Printer | Where-Object { @(\u00272FL02588\u0027, \u00272FL07038\u0027, \u0027QLC31644\u0027, \u0027XVC08019\u0027, \u0027XVF14345\u0027, \u0027QNW11407\u0027) -contains $_.Name }))"}],"Name":"Remove Eksamens Printers","FilesToDwnload":[{"FileName":"Remove-Printers.ps1","URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Remove-Printers.ps1"}],"Execution":[{"Execute":"powershell.exe","Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Remove-Printers.ps1"}]},{"wrkDir":"C:\\Windows\\Temp","Detection":[{"Rule":"if((Get-WMIObject -class Win32_ComputerSystem | Select-Object -ExpandProperty Username) -like \"*eksamen*\"){$Install = $true}elseif(Get-Printer | Where-Object {@(\u0027\\\\10.85.207.8\\2FL02588\u0027,\u0027\\\\10.85.207.8\\2FL07038\u0027,\u0027\\\\10.85.207.8\\QLC31644\u0027,\u0027\\\\10.85.207.8\\XVC08019\u0027,\u0027\\\\10.85.207.8\\XVF14345\u0027,\u0027\\\\10.85.207.8\\QNW11407\u0027) -contains $_.Name }) {$Install = $true};[bool](!($Install -eq $true))"}],"Name":"Set up eksamen printers","FilesToDwnload":[{"FileName":"Install-EksamenPrinters.ps1","URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Install-EksamenPrinters.ps1"}],"Execution":[{"Execute":"powershell.exe","Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Install-EksamenPrinters.ps1"}]},{"wrkDir":"C:\\Windows\\Temp","Detection":[{"Rule":"(!(Get-Printer -Name \"HortenPrintElev\"))"}],"Name":"Install uniFlow printer","FilesToDwnload":[{"FileName":"Install-UniflowPrinter.ps1","URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Install-UniflowPrinter.ps1"},{"FileName":"uniflow_pclxl.zip","URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/bin/uniflow_pclxl.zip"}],"Execution":[{"Execute":"powershell.exe","Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Install-UniflowPrinter.ps1"}]}]
