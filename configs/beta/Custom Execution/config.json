[{"FilesToDwnload":[{"URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Run-PwrcfgWakeTimers.ps1","FileName":"Run-PwrcfgWakeTimers.ps1"}],"Detection":[{"Rule":"$OP = (powercfg /query SCHEME_CURRENT 238c9fa8-0aad-41ed-83f4-97be242c8f20 bd3b718a-0680-4d9d-8ab2-e1d2b4ac806d);[bool]($OP -like \"*Current AC Power Setting Index: 0x00000001*\") -and ($OP -like \"*Current DC Power Setting Index: 0x00000001*\")"}],"Execution":[{"Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Run-PwrcfgWakeTimers.ps1","Execute":"powershell.exe"}],"Name":"Enable Wake Timers","wrkDir":"C:\\Windows\\Temp"},{"FilesToDwnload":[{"URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Install-UniflowPrinter.ps1","FileName":"Install-UniflowPrinter.ps1"},{"URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/bin/uniflow_pclxl.zip","FileName":"uniflow_pclxl.zip"}],"Detection":[{"Rule":"New-PSDrive -PSProvider Registry -Name HKU -Root HKEY_USERS;$Username = Get-WMIObject -class Win32_ComputerSystem | Select-Object -ExpandProperty Username; $ObjUser = New-Object System.Security.Principal.NTAccount($Username);$SID = $Objuser.Translate([System.Security.Principal.SecurityIdentifier]) | Select-Object -ExpandProperty Value;[bool]((Get-Printer -Name \"HortenPrintElev\") -and (Test-Path \"HKU:\\$SID\\Software\\Wow6432Node\\NT-Ware\\MOMUD\"))"}],"Execution":[{"Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Install-UniflowPrinter.ps1","Execute":"powershell.exe"}],"Name":"Install uniFlow printer","wrkDir":"C:\\Windows\\Temp"},{"FilesToDwnload":[{"URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Install-UFRIIDriver.ps1","FileName":"Install-UFRIIDriver.ps1"},{"URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/bin/cnlb0m.zip","FileName":"cnlb0m.zip"}],"Detection":[{"Rule":"[bool](Get-PrinterDriver -Name \"Canon Generic Plus UFR II\")"}],"Execution":[{"Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Install-UFRIIDriver.ps1","Execute":"powershell.exe"}],"Name":"Install Print Driver","wrkDir":"C:\\Windows\\Temp"},{"FilesToDwnload":[{"URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Install-EksamenPrinters.ps1","FileName":"Install-EksamenPrinters.ps1"}],"Detection":[{"Rule":"if((Get-WMIObject -class Win32_ComputerSystem | Select-Object -ExpandProperty Username) -like \"*eksamen*\"){$Install = $true}elseif(Get-Printer | Where-Object {@('\\\\10.85.207.8\\2FL02588','\\\\10.85.207.8\\2FL07038','\\\\10.85.207.8\\QLC31644','\\\\10.85.207.8\\XVC08019','\\\\10.85.207.8\\XVF14345','\\\\10.85.207.8\\QNW11407') -contains $_.Name }) {$Install = $true};[bool](!($Install -eq $true))"}],"Execution":[{"Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Install-EksamenPrinters.ps1","Execute":"powershell.exe"}],"Name":"Set up eksamen printers","wrkDir":"C:\\Windows\\Temp"},{"FilesToDwnload":[{"URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Set-FirewallRule.ps1","FileName":"Set-FirewallRule.ps1"}],"Detection":[{"Rule":"$false"}],"Execution":[{"Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Set-FirewallRule.ps1","Execute":"powershell.exe"}],"Name":"Install Firewall rules","wrkDir":"C:\\Windows\\Temp"},{"FilesToDwnload":[{"URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Delete-TeamsIcon.ps1","FileName":"Delete-TeamsIcon.ps1"}],"Detection":[{"Rule":"$false"}],"Execution":[{"Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Delete-TeamsIcon.ps1","Execute":"powershell.exe"}],"Name":"Delete Microsoft Teams leagcy icon","wrkDir":"C:\\Windows\\Temp"},{"FilesToDwnload":[{"URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Disable-NBT-NS.ps1","FileName":"Disable-NBT-NS.ps1"}],"Detection":[{"Rule":"[bool](!(Get-ItemProperty \"HKLM:\\SYSTEM\\CurrentControlSet\\services\\NetBT\\Parameters\\Interfaces\\tcpip*\" -Name NetbiosOptions | Where-Object { $_.NetbiosOptions -ne 2 }))"}],"Execution":[{"Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Disable-NBT-NS.ps1","Execute":"powershell.exe"}],"Name":"Disable NBT-NS","wrkDir":"C:\\Windows\\Temp"},{"FilesToDwnload":[{"URL":"https://raw.githubusercontent.com/Hortenkommune/ContinuousDelivery4Intune/master/resources/scripts/Set-HighPerfmode.ps1","FileName":"Run-PwrcfgWakeTimers.ps1"}],"Detection":[{"Rule":"[bool]($False)"}],"Execution":[{"Arguments":"-ExecutionPolicy Bypass -File C:\\Windows\\Temp\\Set-HighPerfmode.ps1","Execute":"powershell.exe"}],"Name":"Enable High Performance Mode","wrkDir":"C:\\Windows\\Temp"}]
