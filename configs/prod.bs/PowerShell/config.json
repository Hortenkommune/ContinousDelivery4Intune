[{"Detection":"[bool](!(Test-Path -Path \u0022C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\TightVNC\u0022))","Command":"Remove-Item -Path \u0027C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\TightVNC\u0027 -Recurse -Force","Name":"Remove VNC from Start Menu"},{"Detection":"[bool](Get-ScheduledTask -TaskName \u0027Nightly Reboot\u0027)","Command":"Register-ScheduledTask -Action (New-ScheduledTaskAction -Execute \u0027Powershell.exe\u0027 -Argument \u0027-Command Restart-Computer -Force\u0027) -Trigger (New-ScheduledTaskTrigger -Daily -At 09:00pm) -User \u0027SYSTEM\u0027 -RunLevel Highest -Settings (New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -DontStopOnIdleEnd -WakeToRun) -TaskName \u0027Nightly Reboot\u0027 -Description \u0027Restart Computer nightly\u0027","Name":"Add Restart-Computer every night"},{"Detection":"$Username = (Get-WMIObject -class Win32_ComputerSystem | Select-Object -ExpandProperty Username); $Username = $Username -replace \u0022SKOLE\\\\\u0022,\u0022\u0022;[bool](!(Test-Path \u0022C:\\Users\\$Username\\OneDrive - Horten kommune\\desktop.ini\u0022))","Command":"New-Variable Username -Value (Get-WMIObject -class Win32_ComputerSystem | Select-Object -ExpandProperty Username); Set-Variable Username -Value ($Username -replace \u0027SKOLE\\\\\u0027, \u0027\u0027); Remove-Item (\u0027C:\\Users\\\u0027 + $Username + \u0027\\OneDrive - Horten kommune\\desktop.ini\u0027) -Force","Name":"Remove desktop.ini from OneDrive"},{"Detection":"[bool](!(Get-Printer | Where-Object { @(\u00272FL02588\u0027, \u00272FL07038\u0027, \u0027QLC31644\u0027, \u0027XVC08019\u0027, \u0027XVF14345\u0027, \u0027QNW11407\u0027, \u0027HK-ELEVv1\u0027) -contains $_.Name }))","Command":"@(\u00272FL02588\u0027, \u00272FL07038\u0027, \u0027QLC31644\u0027, \u0027XVC08019\u0027, \u0027XVF14345\u0027, \u0027QNW11407\u0027, \u0027HK-ELEVv1\u0027) | ForEach-Object { if (Get-Printer -Name $_) { Remove-Printer -Name $_ } }","Name":"Remove old printers"},{"Detection":"$false","Command":"Get-ScheduledTask | Where-Object {$_.TaskName -eq \u0027PushLaunch\u0027 } | Start-ScheduledTask","Name":"Intune Sync"},{"Detection":"[bool](!(Get-WmiObject -Query \u0022select * from win32_computersystem where model like \u002720DA%\u0027\u0022)) -or ((Get-PnpDevice \u0022HDAUDIO\\FUNC_01\u0026VEN_10EC\u0026DEV_0283*\u0022).FriendlyName -like \u0022High Definition*\u0022)","Command":"Start-Process \u0022devcon64\u0022 -ArgumentList \u0022update\u0022,\u0022C:\\windows\\inf\\hdaudio.inf\u0022,\u0027\\\u0022\u0022HDAUDIO\\FUNC_01\u0026VEN_10EC\u0026DEV_0283\\\u0022\u0022\u0027","Name":"Run DevCon64"},{"Detection":"$false","Command":"choco pin add -n=audacity --version 2.4.2","Name":"Pin Audacity to 2.4.2"},{"Detection":"[bool](Get-ScheduledTask -TaskName \u0027Software Update Application\u0027 | Where-Object {$_.State -eq \u0027Disabled\u0027})","Command":"Get-ScheduledTask -TaskName \u0027Software Update Application\u0027 | Disable-ScheduledTask","Name":"Disable Acer Quick Access"}]
